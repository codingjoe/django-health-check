<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
      {% block title %}
        System status
      {% endblock title %}
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex">
    <link rel="alternate"
          type="application/json"
          title="JSON"
          href="?format=json">
    <link rel="alternate"
          type="application/atom+xml"
          title="Atom Feed"
          href="?format=atom">
    <link rel="alternate"
          type="application/rss+xml"
          title="RSS Feed"
          href="?format=rss">
    <link rel="alternate"
          type="application/openmetrics-text"
          title="OpenMetrics"
          href="?format=openmetrics">
    <style>
    :root {
      color-scheme: light dark;
      font-family: -apple-system, BlinkMacSystemFont, avenir next, avenir, segoe ui, helvetica neue, Adwaita Sans, Cantarell, Ubuntu, roboto, noto, helvetica, arial, sans-serif;
    }
    html, body {
      margin: 0 auto;
      max-width: 1200px;
      background: light-dark(#dadada, black);
    }

    h1 {
      text-align: center;
      font-weight: normal;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      text-align: left;
      table-layout: auto;
    }

    table tr {
      background-color: light-dark(white, #121212);
    }

    table tr:nth-child(2n) {
      background-color: light-dark(#f1f1f1, #1e1e1e);
    }

    td, th {
      padding: 0.5em 1.5em;
    }

    .align-right {
      text-align: right;
    }

    .mono {
      font-family: Menlo, Consolas, Monaco, Adwaita Mono, Liberation Mono, Lucida Console, monospace;
    }

    tr.error {
      background: light-dark(lightcoral, #440000);
    }

    table thead tr {
      background-color: darkslategray;
      color: white;
    }

    table thead tr.thead-error {
      background-color: darkred;
    }

    table .shrink {
      width: min-content;
      white-space: nowrap;
    }

    footer .footer-text {
      text-align: center;
      font-size: small;
      color: light-dark(#444, #888);
      margin-top: 2em;
    }

    @media screen and (max-width: 700px) {

      table,
      thead,
      tbody,
      th,
      td,
      tr {
          display: block;
      }

      thead tr {
          position: absolute;
          top: -9999px;
          left: -9999px;
      }

      tr {
          margin-bottom: 1.5em;
        box-shadow: 0 0 5px light-dark(#ccc, #000);
        overflow-x: auto;
      }

      td {
          border: none;
          position: relative;
          padding: 1em 0.5em 1em 6em;
      }

      td:before {
          position: absolute;
          left: 1.5em;
          content: attr(data-label);
          font-weight: bold;
      }

      .align-right {
        text-align: unset;
      }
    }
    </style>
    {% block extra_head %}
    {% endblock extra_head %}
  </head>
  <body>
    {% block content %}
      <h1>
        {% if errors %}
          <span role="img" aria-label="Error">ðŸ”¥</span>
        {% endif %}
        System status
        {% if errors %}
          <span role="img" aria-label="Error">ðŸ”¥</span>
        {% endif %}
      </h1>
      <table>
        <thead>
          <tr {% if errors %}class="thead-error"{% endif %}>
            <th>
              Service
            </th>
            <th>
              Status
            </th>
            <th class="align-right shrink">
              Timing
            </th>
          </tr>
        </thead>
        <tbody>
          {% for result in results %}
            <tr {% if result.error %}class="error"{% endif %}>
              <td data-label="Service">
                {{ result.check|stringformat:'r' }}
              </td>
              <td data-label="Status" class="mono">
                {{ result.error|default_if_none:"OK"|linebreaks }}
              </td>
              <td data-label="Timing" class="align-right mono">
                {{ result.time_taken|floatformat:3 }}&#x202F;s
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <footer>
        <p class="footer-text">
          Generated at {% now "SHORT_DATETIME_FORMAT" %} with <a href="https://codingjoe.dev/django-health-check/">Django Health Check</a>.
          <br>
          Subscribe: <a href="?format=atom">Atom</a> | <a href="?format=rss">RSS</a> | <a href="?format=openmetrics">OpenMetrics</a>
        </p>
      </footer>
    {% endblock content %}
  </body>
</html>
